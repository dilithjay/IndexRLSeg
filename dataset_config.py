sample_dict = {
    "train": {
        "car": [
            322,
            348,
            137,
            95,
            21,
            114,
            297,
            405,
            80,
            397,
            367,
            161,
            175,
            185,
            396,
            421,
            390,
            323,
            267,
            319,
        ],
        "person": [
            583,
            80,
            623,
            145,
            398,
            241,
            294,
            417,
            473,
            521,
            406,
            298,
            82,
            576,
            173,
            26,
            297,
            527,
            120,
            103,
        ],
        "bike": [
            48,
            98,
            80,
            21,
            235,
            72,
            23,
            190,
            186,
            231,
            155,
            126,
            99,
            45,
            174,
            64,
            160,
            30,
            148,
            226,
        ],
        "cloud": [
            92,
            82,
            45,
            28,
            55,
            44,
            85,
            33,
            51,
            63,
            98,
            55,
            30,
            82,
            67,
            27,
            99,
            107,
            88,
            98,
        ],
        "landslide": [
            305,
            274,
            152,
            93,
            185,
            146,
            283,
            109,
            172,
            211,
            328,
            182,
            102,
            273,
            223,
            90,
            329,
            355,
            293,
            326,
        ],
        "grass": [
            1,
            83,
            21,
            62,
            25,
            85,
            117,
            67,
            132,
            30,
            115,
            54,
            96,
            103,
            113,
            23,
            42,
            31,
            123,
            36,
        ],
        "sand": [
            51,
            13,
            41,
            57,
            16,
            22,
            36,
            7,
            48,
            45,
            3,
            10,
            24,
            14,
            38,
            30,
            2,
            55,
            5,
            4,
        ],
        "rit18": [
            130,
            61,
            25,
            213,
            190,
            157,
            168,
            225,
            298,
            127,
            161,
            52,
            4,
            199,
            159,
            20,
            36,
            120,
            13,
            310,
        ],
        "irseg": [
            394,
            776,
            430,
            41,
            265,
            523,
            497,
            414,
            310,
            488,
            366,
            597,
            223,
            516,
            142,
            288,
            143,
            773,
            97,
            633,
        ],
    },
    "val": {
        "car": [9, 171, 247, 94, 72, 95, 114, 98, 41, 16],
        "person": [166, 27, 82, 15, 112, 205, 191, 93, 16, 220],
        "bike": [44, 184, 48, 85, 57, 154, 178, 62, 143, 60],
        "cloud": [6, 14, 17, 13, 9, 2, 8, 12, 18, 19],
        "landslide": [16, 37, 46, 35, 24, 5, 22, 31, 47, 50],
        "grass": [10, 48, 62, 20, 22, 9, 57, 51, 35, 58],
        "sand": [14, 29, 0, 12, 3, 5, 22, 20, 24, 15],
        "rit18": [147, 123, 18, 101, 23, 120, 72, 90, 59, 69],
        "irseg": [282, 244, 226, 266, 133, 31, 280, 7, 47, 368],
    },
    "test": {
        "car": [
            55,
            111,
            61,
            208,
            194,
            116,
            191,
            74,
            197,
            90,
            184,
            107,
            171,
            77,
            195,
            81,
            15,
            14,
            93,
            19,
        ],
        "person": [
            34,
            22,
            207,
            118,
            130,
            170,
            74,
            270,
            166,
            280,
            31,
            228,
            190,
            175,
            210,
            131,
            187,
            55,
            290,
            226,
        ],
        "bike": [
            143,
            96,
            156,
            49,
            69,
            81,
            122,
            70,
            72,
            94,
            133,
            123,
            137,
            59,
            64,
            135,
            13,
            3,
            30,
            55,
        ],
        "cloud": [19, 12, 11, 0, 2, 14, 9, 10, 8, 15, 3, 7, 18, 5, 17, 6, 16, 13, 4, 1],
        "landslide": [
            18,
            39,
            4,
            43,
            32,
            29,
            44,
            5,
            24,
            13,
            7,
            38,
            16,
            10,
            15,
            40,
            3,
            22,
            31,
            0,
        ],
        "grass": [
            177,
            69,
            127,
            99,
            121,
            217,
            95,
            74,
            131,
            26,
            151,
            0,
            54,
            200,
            9,
            159,
            103,
            206,
            222,
            51,
        ],
        "sand": [
            78,
            13,
            25,
            58,
            18,
            28,
            76,
            10,
            56,
            69,
            65,
            43,
            86,
            46,
            57,
            54,
            7,
            71,
            23,
            24,
        ],
        "rit18": [
            22,
            288,
            36,
            46,
            11,
            190,
            71,
            260,
            55,
            275,
            54,
            81,
            50,
            214,
            173,
            130,
            107,
            177,
            45,
            191,
        ],
        "irseg": [
            128,
            272,
            361,
            308,
            75,
            158,
            50,
            373,
            37,
            350,
            169,
            241,
            286,
            51,
            181,
            222,
            161,
            312,
            327,
            104,
        ],
    },
}


expressions = {
    "car": [
        ["c1", "sqrt", "="],
        ["(", "c2", "sq", "-", "c3", "sqrt", ")", "="],
    ],
    "person": [
        ["(", "c3", "/", "c2", ")", "*", "c0", "="],
        ["c3", "/", "c1", "sq", "*", "c0", "sq", "="],
    ],
    "bike": [
        ["(", "c3", "+", "c1", ")", "sq", "-", "c0", "sqrt", "="],
        ["c3", "*", "c2", "sqrt", "/", "c3", "sq", "="],
    ],
    "cloud": [
        ["(", "c1", "+", "c9", "*", "c10", ")", "sq", "/", "c7", "="],
        [
            "(",
            "c3",
            "-",
            "c0",
            "/",
            "(",
            "c9",
            "*",
            "c3",
            "/",
            "c12",
            ")",
            ")",
            "sq",
            "=",
        ],
    ],
    "landslide": [
        ["c2", "/", "c12", "/", "c4", "*", "c10", "="],
        ["c9", "/", "c2", "+", "c0", "-", "c8", "*", "c8", "+", "c7", "*", "c9", "="],
    ],
    "grass": [
        ["c3", "/", "c5", "*", "c2", "="],
        ["c5", "/", "c0", "+", "c5", "/", "c3", "="],
    ],
    "sand": [
        ["c5", "*", "c2", "/", "(", "c4", "+", "c5", "*", "c5", ")", "="],
        ["c0", "/", "c1", "+", "c2", "/", "c3", "/", "c3", "="],
    ],
    "rit18": [
        ["c3", "/", "c5", "*", "c2", "="],
        ["c5", "/", "c0", "+", "c5", "/", "c3", "="],
    ],
    "irseg": [
        ["c1", "sqrt", "="],
        ["(", "c2", "sq", "-", "c3", "sqrt", ")", "="],
    ],
}

n_channels = {
    "car": 4,
    "person": 4,
    "bike": 4,
    "cloud": 13,
    "landslide": 14,
    "grass": 6,
    "sand": 6,
    "rit18": 6,
    "irseg": 4,
}

n_dataset_classes = {"rit18": 19, "irseg": 9}

ds_replace_indices_1 = {}
for dataset_name in n_channels:
    indices = []
    for replace_idx in range(n_channels[dataset_name]):
        if f"c{replace_idx}" in expressions[dataset_name][0]:
            indices.append((replace_idx,))
    ds_replace_indices_1[dataset_name] = indices

chosen_replace_indices = {
    "car": 1,
    "person": 2,
    "bike": 3,
    "cloud": 7,
    "landslide": 12,
    "grass": 3,
    "sand": 4,
    "rit18": 4,
    "irseg": 2,
}
ds_replace_indices_2 = {}
for dataset_name in n_channels:
    indices = []
    replace_idx_1 = chosen_replace_indices[dataset_name]
    for replace_idx in range(n_channels[dataset_name]):
        if (
            replace_idx != replace_idx_1
            and f"c{replace_idx}" in expressions[dataset_name][1]
        ):
            indices.append((replace_idx_1, replace_idx))
    ds_replace_indices_2[dataset_name] = indices

class_rgb_channels = {
    "car": (2, 1, 0),
    "person": (2, 1, 0),
    "bike": (2, 1, 0),
    "cloud": (3, 2, 1),
    "landslide": (3, 2, 1),
    "grass": (0, 1, 2),
    "sand": (0, 1, 2),
    "rit18": (0, 1, 2),
    "irseg": (2, 1, 0),
}

encoder = "resnet50"

cloud_params = {
    "mean": [
        0.2798,
        0.2524,
        0.2227,
        0.2248,
        0.2356,
        0.2706,
        0.2888,
        0.2754,
        0.2984,
        0.1192,
        0.0115,
        0.1706,
        0.1249,
    ],
    "std": [
        0.0829,
        0.0921,
        0.0929,
        0.1076,
        0.1084,
        0.1097,
        0.1135,
        0.1112,
        0.117,
        0.0596,
        0.0105,
        0.0852,
        0.0713,
    ],
}
landslide_params = {
    "mean": [
        -0.4914,
        -0.3074,
        -0.1277,
        -0.0625,
        0.0439,
        0.0803,
        0.0644,
        0.0802,
        0.3000,
        0.4082,
        0.0823,
        0.0516,
        0.3338,
        0.7819,
    ],
    "std": [
        0.9325,
        0.8775,
        0.8860,
        0.8869,
        0.8857,
        0.8418,
        0.8354,
        0.8491,
        0.9061,
        1.6072,
        0.8848,
        0.9232,
        0.9018,
        1.2913,
    ],
}

rit_params = {
    "mean": [
        1891.65045272,
        2521.19543891,
        1422.18419105,
        2948.7942107,
        3441.26370243,
        2875.65133359,
    ],
    "std": [
        1804.83983012,
        2172.2533375,
        1363.27195711,
        2682.63175179,
        3410.65836792,
        2861.65387216,
    ],
}

optim = "adamw"
seed = 0
metrics = [
    "test_dataset_iou",
    "test_per_image_iou",
]
